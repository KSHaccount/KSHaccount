<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ï≤úÍ≥µÏùò ÎààÎ¨º - 2D Ï†êÌîÑÎßµ Í≤åÏûÑ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #87ceeb 100%);
            overflow: hidden;
            height: 100vh;
        }
        
        .game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }
        
        /* Î©îÏù∏ Î©îÎâ¥ ÌôîÎ©¥ */
        .main-menu {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #0f0f23 0%, #1a1a3a 50%, #2d2d5f 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s ease;
        }
        
        .title {
            font-size: 4rem;
            font-weight: 700;
            color: #87ceeb;
            text-shadow: 0 0 20px rgba(135, 206, 235, 0.5);
            margin-bottom: 1rem;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #b8c6db;
            margin-bottom: 3rem;
            text-align: center;
            line-height: 1.6;
        }
        
        .difficulty-menu {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            align-items: center;
        }
        
        .difficulty-btn {
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 300px;
            text-align: left;
            position: relative;
            overflow: hidden;
        }
        
        .difficulty-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .difficulty-btn:hover::before {
            left: 100%;
        }
        
        .easy {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .normal {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }
        
        .hard {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }
        
        .hardcore {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
        }
        
        .difficulty-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }
        
        /* Í≤åÏûÑ ÌôîÎ©¥ */
        .game-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #87ceeb 0%, #98d8e8 50%, #b8e6b8 100%);
            display: none;
        }
        
        .game-ui {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            color: white;
            font-weight: 600;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .lives {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .progress {
            font-size: 1rem;
        }
        
        .game-world {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        /* ÌîåÎ†àÏù¥Ïñ¥ Ï∫êÎ¶≠ÌÑ∞ */
        .player {
            position: absolute;
            width: 40px;
            height: 50px;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            border-radius: 20px 20px 10px 10px;
            bottom: 100px;
            left: 100px;
            transition: all 0.1s ease;
            z-index: 50;
        }
        
        .player::before {
            content: 'üëß';
            position: absolute;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 30px;
        }
        
        .player::after {
            content: 'ü¶ã';
            position: absolute;
            top: 10px;
            right: -15px;
            font-size: 20px;
            animation: flutter 0.5s ease-in-out infinite alternate;
        }
        
        /* ÌîåÎû´ÌèºÎì§ */
        .platform {
            position: absolute;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        
        .platform.moving {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .platform.disappearing {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            animation: pulse 1s ease-in-out infinite;
        }
        
        .platform.cloud {
            background: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%);
            border-radius: 50px;
        }
        
        /* Î™©Ìëú ÏßÄÏ†ê */
        .goal {
            position: absolute;
            width: 60px;
            height: 80px;
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            border-radius: 30px;
            top: 50px;
            right: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            animation: goalGlow 2s ease-in-out infinite alternate;
            box-shadow: 0 0 30px rgba(255, 234, 167, 0.6);
        }
        
        .goal::before {
            content: 'üíé';
        }
        
        /* Ïû•Ïï†Î¨º */
        .obstacle {
            position: absolute;
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            border-radius: 50%;
            animation: spin 2s linear infinite;
        }
        
        .obstacle::before {
            content: '‚ö°';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 20px;
        }
        
        /* Í≤åÏûÑ Ïò§Î≤Ñ ÌôîÎ©¥ */
        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 200;
            color: white;
        }
        
        .game-over h2 {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #ff6b6b;
        }
        
        .game-over p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .restart-btn {
            padding: 1rem 2rem;
            font-size: 1.1rem;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .restart-btn:hover {
            transform: scale(1.05);
        }
        
        /* ÏäπÎ¶¨ ÌôîÎ©¥ */
        .victory {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 200;
            color: white;
            text-align: center;
        }
        
        .victory h2 {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #ffeaa7;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        .victory p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            line-height: 1.6;
            max-width: 600px;
        }
        
        /* Ïï†ÎãàÎ©îÏù¥ÏÖò */
        @keyframes glow {
            from { text-shadow: 0 0 20px rgba(135, 206, 235, 0.5); }
            to { text-shadow: 0 0 30px rgba(135, 206, 235, 0.8), 0 0 40px rgba(135, 206, 235, 0.6); }
        }
        
        @keyframes flutter {
            from { transform: translateY(0px) rotate(-5deg); }
            to { transform: translateY(-3px) rotate(5deg); }
        }
        
        @keyframes pulse {
            from { opacity: 1; }
            to { opacity: 0.5; }
        }
        
        @keyframes goalGlow {
            from { box-shadow: 0 0 30px rgba(255, 234, 167, 0.6); }
            to { box-shadow: 0 0 50px rgba(255, 234, 167, 0.9), 0 0 70px rgba(255, 234, 167, 0.6); }
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        /* Ï°∞Ïûë ÏïàÎÇ¥ */
        .controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            color: white;
            font-size: 0.9rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            z-index: 100;
        }
        
        /* Î∞òÏùëÌòï ÎîîÏûêÏù∏ */
        @media (max-width: 768px) {
            .title {
                font-size: 2.5rem;
            }
            
            .difficulty-btn {
                min-width: 250px;
                font-size: 1rem;
            }
            
            .player {
                width: 35px;
                height: 45px;
            }
            
            .controls {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- Î©îÏù∏ Î©îÎâ¥ -->
        <div class="main-menu" id="mainMenu">
            <h1 class="title">Ï≤úÍ≥µÏùò ÎààÎ¨º</h1>
            <p class="subtitle">
                ÏûÉÏñ¥Î≤ÑÎ¶∞ ÎπõÏùÑ ÎêòÏ∞æÍ∏∞ ÏúÑÌïú Íµ¨Î¶Ñ ÏúÑ ÏïÑÏ∞îÌïú Ïó¨Ï†ï<br>
                Ïö©Í∞êÌïú ÏÜåÎÖÄ Î£®ÎÇòÍ∞Ä ÎêòÏñ¥ Ï≤úÍ≥µÏùò ÏÑ¨ÏùÑ Ìñ•Ìï¥ Îñ†ÎÇòÏÑ∏Ïöî
            </p>
            <div class="difficulty-menu">
                <button class="difficulty-btn easy" onclick="startGame('easy')">
                    <strong>üåü Ïâ¨ÏõÄ</strong><br>
                    2Îã® Ï†êÌîÑ Í∞ÄÎä• ‚Ä¢ ÎÑâÎÑâÌïú ÏÉùÎ™ÖÎ†• ‚Ä¢ Ï¥àÎ≥¥Ïûê Ï∂îÏ≤ú
                </button>
                <button class="difficulty-btn normal" onclick="startGame('normal')">
                    <strong>‚ö° Î≥¥ÌÜµ</strong><br>
                    ÏùºÎ∞ò Ï†êÌîÑ ‚Ä¢ ÏÑ∏Ïù¥Î∏å Ìè¨Ïù∏Ìä∏ ÏûàÏùå ‚Ä¢ Ï†ÅÎãπÌïú ÎèÑÏ†Ñ
                </button>
                <button class="difficulty-btn hard" onclick="startGame('hard')">
                    <strong>üî• Ïñ¥Î†§ÏõÄ</strong><br>
                    ÏÑ∏Ïù¥Î∏å Ìè¨Ïù∏Ìä∏ Ï†ÅÏùå ‚Ä¢ ÍπåÎã§Î°úÏö¥ Ïû•Ïï†Î¨º ‚Ä¢ ÏàôÎ†®ÏûêÏö©
                </button>
                <button class="difficulty-btn hardcore" onclick="startGame('hardcore')">
                    <strong>üíÄ ÌïòÎìúÏΩîÏñ¥</strong><br>
                    ÏÑ∏Ïù¥Î∏å ÏóÜÏùå ‚Ä¢ Ìïú Î≤àÏùò Í∏∞Ìöå ‚Ä¢ Í∑πÌïúÏùò ÎèÑÏ†Ñ
                </button>
            </div>
        </div>

        <!-- Í≤åÏûÑ ÌôîÎ©¥ -->
        <div class="game-screen" id="gameScreen">
            <div class="game-ui">
                <div class="lives" id="lives">‚ù§Ô∏è ÏÉùÎ™ÖÎ†•: 3</div>
                <div class="progress" id="progress">ÏßÑÌñâÎèÑ: 0%</div>
            </div>
            
            <div class="controls">
                <div>üéÆ Ï°∞ÏûëÎ≤ï: Ïä§ÌéòÏù¥Ïä§Î∞î/ÌÅ¥Î¶≠ÏúºÎ°ú Ï†êÌîÑ, ÌôîÏÇ¥ÌëúÌÇ§/WASDÎ°ú Ïù¥Îèô</div>
                <div>üì± Î™®Î∞îÏùº: ÌôîÎ©¥ ÌÑ∞ÏπòÎ°ú Ï†êÌîÑ</div>
            </div>
            
            <div class="game-world" id="gameWorld">
                <!-- ÌîåÎ†àÏù¥Ïñ¥ -->
                <div class="player" id="player"></div>
                
                <!-- Í∞ÑÏÜåÌôîÎêú ÌîåÎû´ÌèºÎì§ -->
                <div class="platform" style="width: 200px; height: 20px; bottom: 80px; left: 50px;"></div>
                <div class="platform" style="width: 180px; height: 20px; bottom: 180px; left: 280px;"></div>
                <div class="platform" style="width: 160px; height: 20px; bottom: 280px; left: 500px;"></div>
                <div class="platform" style="width: 140px; height: 20px; bottom: 380px; left: 720px;"></div>
                <div class="platform" style="width: 120px; height: 20px; bottom: 480px; left: 900px;"></div>
                
                <!-- Ïû•Ïï†Î¨º -->
                <div class="obstacle" style="bottom: 220px; left: 400px;"></div>
                
                <!-- Î™©Ìëú ÏßÄÏ†ê -->
                <div class="goal" id="goal" style="bottom: 520px; left: 1050px;"></div>
            </div>
        </div>

        <!-- Í≤åÏûÑ Ïò§Î≤Ñ ÌôîÎ©¥ -->
        <div class="game-over" id="gameOver">
            <h2>üíî Í≤åÏûÑ Ïò§Î≤Ñ</h2>
            <p>Î£®ÎÇòÍ∞Ä Îñ®Ïñ¥Ï°åÏäµÎãàÎã§...<br>Îã§Ïãú ÌïúÎ≤à ÎèÑÏ†ÑÌï¥Î≥¥ÏÑ∏Ïöî!</p>
            <button class="restart-btn" onclick="restartGame()">Îã§Ïãú ÏãúÏûë</button>
        </div>

        <!-- ÏäπÎ¶¨ ÌôîÎ©¥ -->
        <div class="victory" id="victory">
            <h2>üéâ Ï∂ïÌïòÌï©ÎãàÎã§!</h2>
            <p>
                Î£®ÎÇòÍ∞Ä Ï≤úÍ≥µÏùò ÎààÎ¨ºÏùÑ Ï∞æÏïòÏäµÎãàÎã§!<br>
                ÏïÑÎ•¥ÌÖåÎùºÏóê Îã§Ïãú ÎπõÏù¥ ÎèåÏïÑÏò¨ Í≤ÉÏûÖÎãàÎã§.<br>
                Ïö©Í∞êÌïú Î™®ÌóòÍ∞ÄÏó¨, ÎãπÏã†Ïùò Ïö©Í∏∞Ïóê Í∞êÏÇ¨ÎìúÎ¶ΩÎãàÎã§!
            </p>
            <button class="restart-btn" onclick="backToMenu()">Î©îÏù∏ Î©îÎâ¥Î°ú</button>
        </div>
    </div>

    <script>
        // Í≤åÏûÑ ÏÉÅÌÉú Î≥ÄÏàòÎì§
        let gameState = {
            difficulty: 'normal',
            lives: 3,
            maxLives: 3,
            progress: 0,
            isPlaying: false,
            canDoubleJump: false,
            hasDoubleJumped: false,
            playerX: 100,
            playerY: 100,
            velocityX: 0,
            velocityY: 0,
            isJumping: false,
            onGround: true,
            gravity: 0.8,
            jumpPower: 15,
            moveSpeed: 4,
            gameSpeed: 3,
            respawning: false
        };

        // DOM ÏöîÏÜåÎì§
        const mainMenu = document.getElementById('mainMenu');
        const gameScreen = document.getElementById('gameScreen');
        const gameOver = document.getElementById('gameOver');
        const victory = document.getElementById('victory');
        const player = document.getElementById('player');
        const livesDisplay = document.getElementById('lives');
        const progressDisplay = document.getElementById('progress');
        const movingPlatform1 = document.getElementById('movingPlatform1');
        const goal = document.getElementById('goal');

        // ÌîåÎû´Ìèº Îç∞Ïù¥ÌÑ∞ - Îçî ÏâΩÍ≥† Îπ†Î•∏ ÌÅ¥Î¶¨Ïñ¥Î•º ÏúÑÌï¥ Í∞ÑÏÜåÌôî
        const platforms = [
            {x: 50, y: 80, width: 200, height: 20, type: 'normal'},
            {x: 280, y: 180, width: 180, height: 20, type: 'normal'},
            {x: 500, y: 280, width: 160, height: 20, type: 'normal'},
            {x: 720, y: 380, width: 140, height: 20, type: 'normal'},
            {x: 900, y: 480, width: 120, height: 20, type: 'normal'}
        ];

        // Ïû•Ïï†Î¨º Îç∞Ïù¥ÌÑ∞ - Í∞úÏàò Ï§ÑÏûÑ
        const obstacles = [
            {x: 400, y: 220, width: 30, height: 30}
        ];

        // Í≤åÏûÑ ÏãúÏûë
        function startGame(difficulty) {
            gameState.difficulty = difficulty;
            
            // ÎÇúÏù¥ÎèÑÎ≥Ñ ÏÑ§Ï†ï
            switch(difficulty) {
                case 'easy':
                    gameState.lives = 5;
                    gameState.maxLives = 5;
                    gameState.canDoubleJump = true;
                    gameState.jumpPower = 16;
                    gameState.moveSpeed = 5;
                    break;
                case 'normal':
                    gameState.lives = 3;
                    gameState.maxLives = 3;
                    gameState.canDoubleJump = false;
                    gameState.jumpPower = 15;
                    gameState.moveSpeed = 4;
                    break;
                case 'hard':
                    gameState.lives = 2;
                    gameState.maxLives = 2;
                    gameState.canDoubleJump = false;
                    gameState.jumpPower = 14;
                    gameState.moveSpeed = 3;
                    break;
                case 'hardcore':
                    gameState.lives = 1;
                    gameState.maxLives = 1;
                    gameState.canDoubleJump = false;
                    gameState.jumpPower = 13;
                    gameState.moveSpeed = 3;
                    break;
            }
            
            // Í≤åÏûÑ Ï¥àÍ∏∞Ìôî
            gameState.isPlaying = true;
            gameState.progress = 0;
            gameState.playerX = 100;
            gameState.playerY = 100;
            gameState.velocityY = 0;
            gameState.isJumping = false;
            gameState.onGround = true;
            gameState.hasDoubleJumped = false;
            gameState.respawning = false;
            
            // ÌôîÎ©¥ Ï†ÑÌôò
            mainMenu.style.display = 'none';
            gameScreen.style.display = 'block';
            
            updateUI();
            gameLoop();
        }

        // Ï†êÌîÑ Ìï®Ïàò
        function jump() {
            if (!gameState.isPlaying || gameState.respawning) return;
            
            if (gameState.onGround) {
                // Ï≤´ Î≤àÏß∏ Ï†êÌîÑ (ÎïÖÏóê ÏûàÏùÑ ÎïåÎßå)
                gameState.velocityY = -gameState.jumpPower;
                gameState.isJumping = true;
                gameState.onGround = false;
                gameState.hasDoubleJumped = false;
            } else if (gameState.canDoubleJump && !gameState.hasDoubleJumped) {
                // ÎçîÎ∏î Ï†êÌîÑ (Ïâ¨ÏõÄ Î™®ÎìúÏóêÏÑúÎßå)
                gameState.velocityY = -gameState.jumpPower * 0.8;
                gameState.hasDoubleJumped = true;
            }
        }

        // Ï∂©Îèå Í∞êÏßÄ
        function checkCollision(rect1, rect2) {
            return rect1.x < rect2.x + rect2.width &&
                   rect1.x + rect1.width > rect2.x &&
                   rect1.y < rect2.y + rect2.height &&
                   rect1.y + rect1.height > rect2.y;
        }

        // ÌîåÎû´Ìèº Ï∂©Îèå ÌôïÏù∏
        function checkPlatformCollisions() {
            const playerRect = {
                x: gameState.playerX,
                y: window.innerHeight - gameState.playerY - 50,
                width: 40,
                height: 50
            };

            gameState.onGround = false;

            for (let platform of platforms) {
                const platformRect = {
                    x: platform.x,
                    y: window.innerHeight - platform.y - platform.height,
                    width: platform.width,
                    height: platform.height
                };

                if (checkCollision(playerRect, platformRect) && gameState.velocityY > 0) {
                    // ÌîåÎ†àÏù¥Ïñ¥Í∞Ä ÌîåÎû´Ìèº ÏúÑÏóê Ï∞©ÏßÄ
                    if (playerRect.y + playerRect.height - 10 <= platformRect.y) {
                        gameState.playerY = platform.y + platform.height;
                        gameState.velocityY = 0;
                        gameState.isJumping = false;
                        gameState.onGround = true;
                        gameState.hasDoubleJumped = false;
                        return true;
                    }
                }
            }
            return false;
        }

        // Ïû•Ïï†Î¨º Ï∂©Îèå ÌôïÏù∏
        function checkObstacleCollisions() {
            const playerRect = {
                x: gameState.playerX,
                y: window.innerHeight - gameState.playerY - 50,
                width: 40,
                height: 50
            };

            for (let obstacle of obstacles) {
                const obstacleRect = {
                    x: obstacle.x,
                    y: window.innerHeight - obstacle.y - obstacle.height,
                    width: obstacle.width,
                    height: obstacle.height
                };

                if (checkCollision(playerRect, obstacleRect)) {
                    return true;
                }
            }
            return false;
        }

        // Î™©Ìëú ÏßÄÏ†ê ÎèÑÎã¨ ÌôïÏù∏
        function checkGoalReached() {
            const playerRect = {
                x: gameState.playerX,
                y: window.innerHeight - gameState.playerY - 50,
                width: 40,
                height: 50
            };

            const goalRect = {
                x: 1050,
                y: window.innerHeight - 580,
                width: 60,
                height: 80
            };

            return checkCollision(playerRect, goalRect);
        }

        // Í≤åÏûÑ Î£®ÌîÑ
        function gameLoop() {
            if (!gameState.isPlaying) return;

            // ÌÇ§Î≥¥Îìú Ïù¥Îèô Ï≤òÎ¶¨
            handleMovement();

            // Ï§ëÎ†• Ï†ÅÏö©
            gameState.velocityY += gameState.gravity;
            gameState.playerY -= gameState.velocityY;

            // ÌîåÎû´Ìèº Ï∂©Îèå ÌôïÏù∏
            checkPlatformCollisions();

            // ÌôîÎ©¥ Î∞ñÏúºÎ°ú Îñ®Ïñ¥Ïßê (Ìïú Î≤àÎßå Ï≤¥ÌÅ¨)
            if (gameState.playerY < -100 && !gameState.respawning) {
                gameState.respawning = true;
                loseLife();
                return;
            }

            // Ïû•Ïï†Î¨º Ï∂©Îèå ÌôïÏù∏ (Ìïú Î≤àÎßå Ï≤¥ÌÅ¨)
            if (checkObstacleCollisions() && !gameState.respawning) {
                gameState.respawning = true;
                loseLife();
                return;
            }

            // Î™©Ìëú ÏßÄÏ†ê ÎèÑÎã¨ ÌôïÏù∏
            if (checkGoalReached()) {
                winGame();
                return;
            }

            // ÏßÑÌñâÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
            gameState.progress = Math.min(100, (gameState.playerX / 1100) * 100);

            // ÌîåÎ†àÏù¥Ïñ¥ ÏúÑÏπò ÏóÖÎç∞Ïù¥Ìä∏
            updatePlayerPosition();
            updateUI();

            requestAnimationFrame(gameLoop);
        }

        // ÌîåÎ†àÏù¥Ïñ¥ ÏúÑÏπò ÏóÖÎç∞Ïù¥Ìä∏
        function updatePlayerPosition() {
            player.style.left = gameState.playerX + 'px';
            player.style.bottom = gameState.playerY + 'px';
        }

        // UI ÏóÖÎç∞Ïù¥Ìä∏
        function updateUI() {
            const hearts = '‚ù§Ô∏è'.repeat(gameState.lives) + 'ü§ç'.repeat(gameState.maxLives - gameState.lives);
            livesDisplay.textContent = `${hearts} ÏÉùÎ™ÖÎ†•: ${gameState.lives}`;
            progressDisplay.textContent = `ÏßÑÌñâÎèÑ: ${Math.round(gameState.progress)}%`;
        }

        // ÏõÄÏßÅÏù¥Îäî ÌîåÎû´Ìèº Ïï†ÎãàÎ©îÏù¥ÏÖò
        let platformDirection = 1;
        function animateMovingPlatforms() {
            const currentLeft = parseInt(movingPlatform1.style.left);
            const newLeft = currentLeft + platformDirection * 2;
            
            if (newLeft > 800 || newLeft < 600) {
                platformDirection *= -1;
            }
            
            movingPlatform1.style.left = newLeft + 'px';
            platforms[4].x = newLeft; // ÌîåÎû´Ìèº Îç∞Ïù¥ÌÑ∞ÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
        }

        // ÏÉùÎ™ÖÎ†• ÏûÉÍ∏∞
        function loseLife() {
            gameState.lives--;
            
            if (gameState.lives <= 0) {
                gameState.isPlaying = false;
                gameOver.style.display = 'flex';
            } else {
                // ÏãúÏûë ÏúÑÏπòÎ°ú Ï¶âÏãú Î¶¨ÏÖã
                gameState.playerX = 100;
                gameState.playerY = 100;
                gameState.velocityY = 0;
                gameState.velocityX = 0;
                gameState.isJumping = false;
                gameState.onGround = true;
                gameState.hasDoubleJumped = false;
                
                // UIÏôÄ ÌîåÎ†àÏù¥Ïñ¥ ÏúÑÏπò Ï¶âÏãú ÏóÖÎç∞Ïù¥Ìä∏
                updateUI();
                updatePlayerPosition();
                
                // Ïû†Ïãú ÌõÑ respawning ÌîåÎûòÍ∑∏ Ìï¥Ï†úÌïòÍ≥† Í≤åÏûÑ Î£®ÌîÑ Ïû¨ÏãúÏûë
                setTimeout(() => {
                    gameState.respawning = false;
                    if (gameState.isPlaying) {
                        gameLoop();
                    }
                }, 100);
            }
        }

        // Í≤åÏûÑ ÏäπÎ¶¨
        function winGame() {
            gameState.isPlaying = false;
            victory.style.display = 'flex';
        }

        // Í≤åÏûÑ Ïû¨ÏãúÏûë
        function restartGame() {
            gameOver.style.display = 'none';
            startGame(gameState.difficulty);
        }

        // Î©îÏù∏ Î©îÎâ¥Î°ú ÎèåÏïÑÍ∞ÄÍ∏∞
        function backToMenu() {
            victory.style.display = 'none';
            gameScreen.style.display = 'none';
            mainMenu.style.display = 'flex';
            gameState.isPlaying = false;
        }

        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà
        document.addEventListener('keydown', function(event) {
            if (event.code === 'Space') {
                event.preventDefault();
                jump();
            }
        });

        document.addEventListener('click', function(event) {
            if (gameState.isPlaying) {
                jump();
            }
        });

        document.addEventListener('touchstart', function(event) {
            if (gameState.isPlaying) {
                event.preventDefault();
                jump();
            }
        });

        // ÌÇ§Î≥¥Îìú Ïù¥Îèô (Ï∂îÍ∞Ä Í∏∞Îä•)
        const keys = {};
        document.addEventListener('keydown', function(event) {
            keys[event.code] = true;
        });
        
        document.addEventListener('keyup', function(event) {
            keys[event.code] = false;
        });
        
        function handleMovement() {
            if (!gameState.isPlaying) return;
            
            if (keys['ArrowLeft'] || keys['KeyA']) {
                gameState.playerX = Math.max(0, gameState.playerX - gameState.moveSpeed);
            }
            if (keys['ArrowRight'] || keys['KeyD']) {
                gameState.playerX = Math.min(window.innerWidth - 40, gameState.playerX + gameState.moveSpeed);
            }
        }

        // ÌôîÎ©¥ ÌÅ¨Í∏∞ Î≥ÄÍ≤Ω ÎåÄÏùë
        window.addEventListener('resize', function() {
            // Î™©Ìëú ÏúÑÏπò Ïû¨Ï°∞Ï†ï
            goal.style.right = '100px';
            goal.style.top = '50px';
        });

        // Ï¥àÍ∏∞ Î™©Ìëú ÏúÑÏπò ÏÑ§Ï†ï
        goal.style.right = '100px';
        goal.style.top = '50px';
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96ad0347a1bfa2b5',t:'MTc1NDQ2NzM1NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
